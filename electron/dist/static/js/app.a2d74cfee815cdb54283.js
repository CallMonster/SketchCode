webpackJsonp([2,0],[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var r=i(22),o=n(r),s=i(79),c=n(s),d=i(26),u=n(d);o.default.config.debug={NODE_ENV:"production"}.DEBUG_MODE,new o.default({el:"#app",store:u.default,template:"<App/>",components:{App:c.default}})},,,,,,,,,function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(11),o=n(r),s=i(34),c=n(s),d={currentProjectId:null,projects:[]},u="sketch_code",a=window.localStorage;e.default={init:function(){var t=a.getItem(u);if(t){var e=JSON.parse(t);return(0,o.default)(e)}return a.setItem(u,(0,c.default)(d)),(0,o.default)(d)},update:function(t){a.setItem(u,(0,c.default)(t))}}},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={SWITCH_PROJECT:"SWITCH_PROJECT",ADD_PROJECT:"ADD_PROJECT",UPDATE_PROJECT:"UPDATE_PROJECT",DESTROY_PROJECT:"DESTROY_PROJECT"}},,,,,,,,,,,,,function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={upper:function(t){return t.toString().toUpperCase()}}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(10),o=n(r);e.default={switchProject:function(t,e){var i=t.commit;i(o.default.SWITCH_PROJECT,e)},addProject:function(t,e){var i=t.commit;i(o.default.ADD_PROJECT,e)},updateProject:function(t,e){var i=t.commit;i(o.default.UPDATE_PROJECT,e)},destroyProject:function(t,e){var i=t.commit;i(o.default.DESTROY_PROJECT,e)}}},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={currentProjectId:function(t){return t.currentProjectId},currentProject:function(t){return t.currentProjectId?t.projects.find(function(e){return e.id===t.currentProjectId}):null},projects:function(t){return t.projects},projectCount:function(t){return t.projects.length}}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(22),o=n(r),s=i(2),c=n(s),d=i(24),u=n(d),a=i(25),h=n(a),l=i(27),f=n(l),p=i(9),m=n(p);o.default.use(c.default);var v=m.default.init();e.default=new c.default.Store({state:v,getters:h.default,actions:u.default,mutations:f.default})},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function r(t,e){t.currentProjectId=e,p.default.update(t)}function o(t){var e=Date.now(),i={id:"p_"+e,name:"Untitled",html:"",style:"",js:"",created_at:e,modified_at:e};t.projects.push(i),r(t,i.id)}function s(t,e){var i=t.projects.find(function(t){return t.id===e.id});if(i){for(var n in e)i[n]=e[n];i.modified_at=Date.now()}p.default.update(t)}function c(t,e){var i=t.projects.find(function(t){return t.id===e}),n=t.projects.indexOf(i);t.projects.splice(n,1);var o=t.projects.sort(function(t,e){return t.modified_at<e.modified_at});o.length?r(t,o[0].id):r(t,null)}Object.defineProperty(e,"__esModule",{value:!0});var d,u=i(12),a=n(u),h=i(10),l=n(h),f=i(9),p=n(f);e.default=(d={},(0,a.default)(d,l.default.SWITCH_PROJECT,function(t,e){var i=e.id;r(t,i)}),(0,a.default)(d,l.default.ADD_PROJECT,function(t){o(t)}),(0,a.default)(d,l.default.UPDATE_PROJECT,function(t,e){s(t,e)}),(0,a.default)(d,l.default.DESTROY_PROJECT,function(t,e){var i=e.id;c(t,i)}),d)},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(3),o=n(r),s=i(81),c=n(s),d=i(82),u=n(d),a=i(83),h=n(a),l=i(2);i(71),e.default={name:"app",data:function(){return{winWidth:0,minWidth:50,width:{projectList:200,projectListHolder:0,editorWrapper:400},moving:!1,hideProjectList:!1}},components:{EditorWrapper:c.default,Preview:u.default,ProjectList:h.default},computed:(0,o.default)({},(0,l.mapGetters)(["currentProjectId","projectCount"]),{projectListWidth:function(){return{width:this.width.projectList+"px"}},editorWrapperWidth:function(){return{width:this.width.editorWrapper+"px"}},dev:function(){return"http:"===window.location.protocol},hasProject:function(){return this.projectCount>0},tipsStyle:function(){return{left:this.width.projectList+"px"}}}),created:function(){this.winWidth=window.innerWidth,window.addEventListener("resize",this.handleResize)},mounted:function(){this.initShortcut()},methods:{handleResize:function(){this.winWidth=window.innerWidth},resize:function(t,e){var i=this;this.cleanMouseEvent();var n=t.clientX,r=this.width[e],o=this.width["editorWrapper"===e?"projectList":"editorWrapper"];this.moving=!0,window.onmousemove=function(t){var s=t.clientX-n;r+s<i.minWidth?i.width[e]=i.minWidth:i.winWidth-(r+s)-o<i.minWidth?i.width[e]=i.winWidth-i.minWidth-o:i.width[e]=r+s},window.onmouseup=this.cleanMouseEvent},cleanMouseEvent:function(){this.moving=!1,window.onmousemove=null,window.onmouseup=null},initShortcut:function(){document.addEventListener("keydown",this.shortcutKeydown,!1),document.addEventListener("keyup",this.shortcutKeyup,!1);var t=this.$refs.previewRef.$el.querySelector("iframe").contentDocument;t.addEventListener("keydown",this.shortcutKeydown,!1),t.addEventListener("keyup",this.shortcutKeyup,!1)},shortcutKeydown:function(t){91===t.keyCode?this.commandKey=!0:!this.commandKey||78!==t.keyCode&&(75===t.keyCode,1)?this.commandKey&&8===t.keyCode?this.distroyProject():this.commandKey&&191===t.keyCode&&this.toggleProjectList():this.newProject()},shortcutKeyup:function(t){this.commandKey=!1},newProject:function(){this.$store.dispatch("addProject")},distroyProject:function(){window.confirm("Are you sure to delete current project?")&&this.$store.dispatch("destroyProject",{id:this.currentProjectId}),this.commandKey=!1},toggleProjectList:function(){0===this.width.projectList?(this.width.projectList=this.width.projectListHolder,this.winWidth-this.width.projectList-this.width.editorWrapper<this.minWidth&&(this.width.editorWrapper=this.winWidth-this.width.projectList-this.minWidth)):(this.width.projectListHolder=this.width.projectList,this.width.projectList=0)}}}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(1),o=n(r);i(69),i(70),i(14),i(38),i(13),i(15),i(68),i(37);var s=i(78),c=n(s),d=i(23),u=n(d);e.default={name:"Editor",props:["type","height","code","currentProjectId"],data:function(){return{input:"",codeMirror:null}},filters:u.default,watch:{currentProjectId:function(){this.initCode()}},computed:{typeName:function(){var t={html:"html",style:"css",js:"js"};return t[this.type]}},mounted:function(){this.initEditor(),this.initCode(),this.initChange()},methods:{initEditor:function(){var t={html:"htmlmixed",style:"css",js:"javascript"};this.codeMirror=(0,o.default)(this.$el.querySelector(".inputarea"),{lineNumbers:!0,mode:t[this.type],lineWrapping:!0,theme:"material",scrollbarStyle:"overlay",tabSize:2}),this.$el.querySelector(".CodeMirror-scroll").style.height=this.$el.clientHeight},initCode:function(){this.setCodeMirrorValue(this.code)},initChange:function(){var t=this;this.codeMirror.on("change",c.default.debounce(function(){var e=t.codeMirror.getValue().trim();e!==t.code&&t.$emit("updateCode",t.type,e)},300))},setCodeMirrorValue:function(t){this.codeMirror.getDoc().setValue(t)}}}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(12),o=n(r),s=i(3),c=n(s),d=i(80),u=n(d),a=i(2);e.default={name:"EditorWrapper",props:{width:Number},data:function(){return{winHeight:0,minHeight:50,height:{html:0,style:0,js:0}}},components:{Editor:u.default},computed:(0,c.default)({},(0,a.mapGetters)(["currentProjectId","currentProject"]),{editorWrapperWidth:function(){return{width:this.width+"px"}}}),watch:{currentProjectId:function(){this.$emit("initCode")}},created:function(){this.winHeight=window.innerHeight;for(var t in this.height)this.height[t]=this.winHeight/3;window.addEventListener("resize",this.handleResize)},methods:{handleResize:function(){this.winHeight=window.innerHeight;var t=0;for(var e in this.height)t+=this.height[e];for(var i in this.height)this.height[i]=this.winHeight*this.height[i]/t},updateCode:function(t,e){this.$store.dispatch("updateProject",(0,o.default)({id:this.currentProject.id},t,e))},resizeEditor:function(t,e,i){var n=this;this.cleanMouseEvent();var r=t.clientY,o=this.height[e],s=this.height[i];document.onmousemove=function(t){var c=t.clientY-r;o+c<n.minHeight?(n.height[e]=n.minHeight,n.height[i]=o+s-n.minHeight):s-c<n.minHeight?(n.height[e]=o+s-n.minHeight,n.height[i]=n.minHeight):(n.height[i]=s-c,n.height[e]=o+c)},document.onmouseup=this.cleanMouseEvent},cleanMouseEvent:function(){document.onmousemove=null,document.onmouseup=null}}}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(3),o=n(r),s=i(2);e.default={name:"Preview",data:function(){return{html:"",style:"",js:""}},computed:(0,o.default)({},(0,s.mapGetters)(["currentProject"])),watch:{currentProject:{handler:function(t){return!!t&&void(t.html===this.html&&t.js===this.js&&t.style!==this.style?this.updateStyle():t.html===this.html&&t.js===this.js||this.update())},deep:!0}},mounted:function(){this.currentProject&&this.update()},methods:{update:function(){var t=this.$refs.previewRef.contentDocument;t.body.innerHTML=this.currentProject.html;var e=document.createElement("script");e.type="text/javascript",e.id=this.currentProject.id+"_script",e.textContent=this.currentProject.js;var i=document.createElement("style");i.type="text/css",i.id=this.currentProject.id+"_style",i.textContent=this.currentProject.style,t.body.appendChild(e),t.body.appendChild(i),this.style=this.currentProject.style,this.html=this.currentProject.html,this.js=this.currentProject.js},updateStyle:function(){console.log("updateStyle");var t=this.$refs.previewRef.contentDocument,e=t.getElementById(this.currentProject.id+"_style");e.textContent=this.currentProject.style,this.style=this.currentProject.style},cleanPreview:function(){var t=this.$refs.previewRef.contentDocument;t.body.innerHTML=""}}}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(3),o=n(r),s=i(84),c=n(s),d=i(2);e.default={name:"ProjectList",props:{width:Number},components:{ProjectName:c.default},computed:(0,o.default)({},(0,d.mapGetters)(["projects","currentProjectId"]),{sortedProjects:function(){return this.projects.slice().sort(function(t,e){return e.modified_at-t.modified_at})}})}},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"ProjectName",props:{active:Boolean,project:Object,projectListWidth:String},data:function(){return{name:"",editMode:!1}},methods:{switchProject:function(){this.$store.dispatch("switchProject",{id:this.project.id})},switchEditMode:function(){var t=this;this.editMode=!this.editMode,this.editMode?(this.name=this.project.name,setTimeout(function(){t.$refs.nameInputRef.select()},1)):this.name=""},blurInput:function(){this.$refs.nameInputRef.blur()},save:function(){var t=this,e=this.name.trim();e===this.project.name?this.switchEditMode():""===e?(this.name=this.project.name,this.switchEditMode()):this.$store.dispatch("updateProject",{id:this.project.id,name:e}).then(function(){t.switchEditMode()})},unsave:function(){this.name=this.project.name,this.switchEditMode()}}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},,function(t,e,i){var n,r;i(77),n=i(28);var o=i(90);r=n=n||{},"object"!=typeof n.default&&"function"!=typeof n.default||(r=n=n.default),"function"==typeof r&&(r=r.options),r.render=o.render,r.staticRenderFns=o.staticRenderFns,t.exports=n},function(t,e,i){var n,r;i(72),n=i(29);var o=i(85);r=n=n||{},"object"!=typeof n.default&&"function"!=typeof n.default||(r=n=n.default),"function"==typeof r&&(r=r.options),r.render=o.render,r.staticRenderFns=o.staticRenderFns,t.exports=n},function(t,e,i){var n,r;i(74),n=i(30);var o=i(87);r=n=n||{},"object"!=typeof n.default&&"function"!=typeof n.default||(r=n=n.default),"function"==typeof r&&(r=r.options),r.render=o.render,r.staticRenderFns=o.staticRenderFns,t.exports=n},function(t,e,i){var n,r;i(76),n=i(31);var o=i(89);r=n=n||{},"object"!=typeof n.default&&"function"!=typeof n.default||(r=n=n.default),"function"==typeof r&&(r=r.options),r.render=o.render,r.staticRenderFns=o.staticRenderFns,t.exports=n},function(t,e,i){var n,r;i(75),n=i(32);var o=i(88);r=n=n||{},"object"!=typeof n.default&&"function"!=typeof n.default||(r=n=n.default),"function"==typeof r&&(r=r.options),r.render=o.render,r.staticRenderFns=o.staticRenderFns,t.exports=n},function(t,e,i){var n,r;i(73),n=i(33);var o=i(86);r=n=n||{},"object"!=typeof n.default&&"function"!=typeof n.default||(r=n=n.default),"function"==typeof r&&(r=r.options),r.render=o.render,r.staticRenderFns=o.staticRenderFns,t.exports=n},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:"editor editor-"+t.type,style:{height:t.height+"px"}},[i("div",{staticClass:"type"},[t._v(t._s(t.typeName))]),t._v(" "),i("div",{staticClass:"inputarea"}),t._v(" "),t._t("default")],2)},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"item",class:{active:t.active,"edit-mode":t.editMode}},[i("div",{directives:[{name:"show",rawName:"v-show",value:!t.editMode,expression:"!editMode"}],staticClass:"name",on:{click:t.switchProject,dblclick:t.switchEditMode}},[t._v(t._s(t.project.name))]),t._v(" "),i("input",{directives:[{name:"show",rawName:"v-show",value:t.editMode,expression:"editMode"},{name:"model",rawName:"v-model",value:t.name,expression:"name"}],ref:"nameInputRef",staticClass:"name-input",attrs:{type:"text"},domProps:{value:t._s(t.name)},on:{blur:t.save,keyup:[function(e){t._k(e.keyCode,"enter",13)||t.blurInput(e)},function(e){t._k(e.keyCode,"esc",27)||t.unsave(e)}],input:function(e){e.target.composing||(t.name=e.target.value)}}})])},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{style:t.editorWrapperWidth,attrs:{id:"editor-wrapper"}},[t.currentProject?i("div",[i("Editor",{attrs:{type:"html",height:t.height.html,code:t.currentProject.html,currentProjectId:t.currentProjectId},on:{updateCode:t.updateCode}},[i("div",{staticClass:"row-resizer",on:{mousedown:function(e){t.resizeEditor(e,"html","style")}}})]),t._v(" "),i("Editor",{attrs:{type:"style",height:t.height.style,code:t.currentProject.style,currentProjectId:t.currentProjectId},on:{updateCode:t.updateCode}},[i("div",{staticClass:"row-resizer",on:{mousedown:function(e){t.resizeEditor(e,"style","js")}}})]),t._v(" "),i("Editor",{attrs:{type:"js",height:t.height.js,code:t.currentProject.js,currentProjectId:t.currentProjectId},on:{updateCode:t.updateCode}})],1):t._e(),t._v(" "),t._t("default")],2)},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"project-list"}},[i("h1",{staticClass:"logo"},[t._v("<SketchCode/>")]),t._v(" "),i("div",{staticClass:"list"},[i("div",{staticClass:"inner"},t._l(t.sortedProjects,function(e){return i("ProjectName",{attrs:{project:e,active:e.id===t.currentProjectId}})}))]),t._v(" "),t._t("default")],2)},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"preview-wrapper"}},[i("iframe",{ref:"previewRef",attrs:{id:"preview"}}),t._v(" "),t._t("default")],2)},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("ProjectList",{class:{transition:!t.moving},style:t.projectListWidth},[i("div",{staticClass:"resizer",on:{mousedown:function(e){t.resize(e,"projectList")}}})]),t._v(" "),i("EditorWrapper",{class:{transition:!t.moving},style:t.editorWrapperWidth},[i("div",{staticClass:"resizer",on:{mousedown:function(e){t.resize(e,"editorWrapper")}}})]),t._v(" "),i("Preview",{ref:"previewRef"},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.moving,expression:"moving"}],staticClass:"mask"})]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.hasProject,expression:"!hasProject"}],staticClass:"transition",style:t.tipsStyle,attrs:{id:"tips"}},[i("ul",[t._m(0),t._v(" "),i("li",[t.dev?i("b",[t._v("⌘ + K")]):i("b",[t._v("⌘ + N")]),t._v(" to create a new project")]),t._v(" "),t._m(1),t._v(" "),t._m(2)])])],1)},staticRenderFns:[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("li",[i("b",[t._v("⌘ + /")]),t._v(" to toggle sidebar")])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("li",[i("b",[t._v("⌘ + Del")]),t._v(" to delete current project")])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("li",[i("b",[t._v("Double Click")]),t._v(" project title to rename")])}]}}]);